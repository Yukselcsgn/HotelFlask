{% extends "base.html" %}
{% block title %}FotoÄŸraf YÃ¶netimi - Admin{% endblock %}

{% block content %}
<div class="admin-dashboard">
    <div class="admin-header">
        <h2>ğŸ“¸ FotoÄŸraf YÃ¶netimi</h2>
        <div class="admin-actions">
            <a href="{{ url_for('admin.dashboard') }}" class="back-btn">â† Geri DÃ¶n</a>
        </div>
    </div>
    
    <div class="images-management">
        <div class="upload-section">
            <h3>ğŸ“¤ Yeni FotoÄŸraf YÃ¼kle</h3>
            <form method="POST" action="{{ url_for('admin.upload_image') }}" enctype="multipart/form-data" class="upload-form">
                <div class="form-group">
                    <label for="category">Kategori:</label>
                    <select name="category" required>
                        <option value="room">ğŸ  Oda FotoÄŸrafÄ±</option>
                        <option value="slider">ğŸ–¼ï¸ Anasayfa Slayt</option>
                    </select>
                </div>
                
                <div class="form-group room-type-group" style="display: none;">
                    <label for="room_type">Oda Tipi:</label>
                    <select name="room_type">
                        <option value="standart">Standart</option>
                        <option value="deluxe">Standart Double</option>
                        <option value="suit">Standart Triple</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="image">ğŸ“ FotoÄŸraf SeÃ§:</label>
                    <input type="file" name="image" accept="image/*" required>
                    <small class="file-info">Desteklenen formatlar: JPG, PNG, GIF (Max: 5MB)</small>
                </div>
                
                <button type="submit" class="upload-btn">ğŸ“¤ FotoÄŸraf YÃ¼kle</button>
            </form>
        </div>
        
        <div class="images-sections">
            <div class="room-images">
                <h3>ğŸ  Oda FotoÄŸraflarÄ± ({{ room_images|length }} adet)</h3>
                <div class="image-grid">
                    {% for image in room_images %}
                    <div class="image-card">
                        <div class="image-preview">
                            <img src="{{ url_for('static', filename='images/' + image.room_type + '/' + image.filename) }}" alt="{{ image.filename }}">
                            <div class="image-overlay">
                                <button class="preview-btn" onclick="previewImage('{{ url_for('static', filename='images/' + image.room_type + '/' + image.filename) }}')">ğŸ‘ï¸ Ã–nizle</button>
                            </div>
                        </div>
                        <div class="image-info">
                            <p class="room-type-badge">{{ image.room_type|title }}</p>
                            <p class="filename">{{ image.filename }}</p>
                            <p class="upload-date">YÃ¼klenme: {{ image.uploaded_at.strftime('%d.%m.%Y') if image.uploaded_at else 'Bilinmiyor' }}</p>
                        </div>
                        <div class="image-actions">
                            <form method="POST" action="{{ url_for('admin.delete_image', image_id=image.id) }}" style="display: inline;">
                                <button type="submit" class="delete-btn" onclick="return confirmDelete('{{ image.filename }}')">
                                    ğŸ—‘ï¸ Sil
                                </button>
                            </form>
                        </div>
                    </div>
                    {% else %}
                    <div class="no-images">
                        <p>ğŸ“­ HenÃ¼z oda fotoÄŸrafÄ± yÃ¼klenmemiÅŸ.</p>
                        <p>YukarÄ±daki formu kullanarak ilk fotoÄŸrafÄ±nÄ±zÄ± yÃ¼kleyin.</p>
                    </div>
                    {% endfor %}
                </div>
            </div>
            
            <div class="slider-images">
                <h3>ğŸ–¼ï¸ Anasayfa Slayt FotoÄŸraflarÄ± ({{ slider_images|length }} adet)</h3>
                <div class="image-grid">
                    {% for image in slider_images %}
                    <div class="image-card">
                        <div class="image-preview">
                            <img src="{{ url_for('static', filename='images/' + image.filename) }}" alt="{{ image.filename }}">
                            <div class="image-overlay">
                                <button class="preview-btn" onclick="previewImage('{{ url_for('static', filename='images/' + image.filename) }}')">ğŸ‘ï¸ Ã–nizle</button>
                            </div>
                        </div>
                        <div class="image-info">
                            <p class="filename">{{ image.filename }}</p>
                            <p class="upload-date">YÃ¼klenme: {{ image.uploaded_at.strftime('%d.%m.%Y') if image.uploaded_at else 'Bilinmiyor' }}</p>
                        </div>
                        <div class="image-actions">
                            <form method="POST" action="{{ url_for('admin.delete_image', image_id=image.id) }}" style="display: inline;">
                                <button type="submit" class="delete-btn" onclick="return confirmDelete('{{ image.filename }}')">
                                    ğŸ—‘ï¸ Sil
                                </button>
                            </form>
                        </div>
                    </div>
                    {% else %}
                    <div class="no-images">
                        <p>ğŸ“­ HenÃ¼z slayt fotoÄŸrafÄ± yÃ¼klenmemiÅŸ.</p>
                        <p>YukarÄ±daki formu kullanarak ilk slayt fotoÄŸrafÄ±nÄ±zÄ± yÃ¼kleyin.</p>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Image Preview Modal -->
<div id="imagePreviewModal" class="modal" style="display:none;">
    <div class="modal-content">
        <span class="close" onclick="closePreviewModal()">&times;</span>
        <img id="previewImage" src="" alt="Ã–nizleme">
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// Oda tipi seÃ§imini gÃ¶ster/gizle
document.querySelector('select[name="category"]').addEventListener('change', function() {
    const roomTypeGroup = document.querySelector('.room-type-group');
    if (this.value === 'room') {
        roomTypeGroup.style.display = 'block';
    } else {
        roomTypeGroup.style.display = 'none';
    }
});

// FotoÄŸraf Ã¶nizleme fonksiyonu
function previewImage(imageSrc) {
    const modal = document.getElementById('imagePreviewModal');
    const previewImg = document.getElementById('previewImage');
    previewImg.src = imageSrc;
    modal.style.display = 'block';
}

// Ã–nizleme modalÄ±nÄ± kapat
function closePreviewModal() {
    document.getElementById('imagePreviewModal').style.display = 'none';
}

// Silme onayÄ±
function confirmDelete(filename) {
    return confirm(`"${filename}" dosyasÄ±nÄ± silmek istediÄŸinizden emin misiniz?\n\nBu iÅŸlem geri alÄ±namaz!`);
}

// Modal dÄ±ÅŸÄ±na tÄ±klandÄ±ÄŸÄ±nda kapat
window.onclick = function(event) {
    const modal = document.getElementById('imagePreviewModal');
    if (event.target === modal) {
        modal.style.display = 'none';
    }
}

// ESC tuÅŸu ile modal kapatma
document.addEventListener('keydown', function(event) {
    if (event.key === 'Escape') {
        closePreviewModal();
    }
});
</script>
{% endblock %} 